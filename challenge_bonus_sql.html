<!DOCTYPE html>
<html>
<head>
    <title>Bonus Challenge — SQL Injection Simulation</title>
    <link rel="stylesheet" href="style.css">
</head>
<body>
<div class="container">
    <h1>Bonus Challenge — SQL Injection Simulation</h1>
    <p>
        This is a safe, simulated login system. No real database exists.<br>
        Try entering something interesting as your username.
    </p>

    <input id="user" placeholder="username">
    <button onclick="login()">Login</button>

    <p id="result"></p>

<script>
    function login() {
        const user = document.getElementById("user").value.trim();

        // Define pattern as a string so JS doesn't treat comment markers as JS comments
        const patternString = [
            "((['\"]?\\s*OR\\s+['\"]?\\d+['\"]?\\s*=\\s*['\"]?\\d+))",  // OR 1=1
            "(--|#|\\/\\*)",                                           // comments: --  #  /*
            "(\\bUNION\\b\\s+\\bSELECT\\b)",                           // UNION SELECT
            "(\\bDROP\\b\\s+\\bTABLE\\b)",                             // DROP TABLE
            "(\\bDELETE\\b\\s+\\bFROM\\b)"                             // DELETE FROM
        ].join("|");

        const sqlInjectionPattern = new RegExp(patternString, "i");

        if (sqlInjectionPattern.test(user)) {
            document.getElementById("result").innerHTML =
                "Login bypassed!<br><strong>flag{simple_ctf_sql}</strong>";
        } else {
            document.getElementById("result").innerText = "Invalid username.";
        }
    }
</script>


</div>
</body>
</html>

