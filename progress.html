<!DOCTYPE html>
<html>
<head>
    <title>CTF Progress Tracker with Hints</title>
    <link rel="stylesheet" href="./style.css">
</head>
<body>
<div class="container">
    <h1>CTF Progress Tracker</h1>
    <p>Enter your flags below to track your own progress. Hints are optional and safe.  
    Your progress is saved locally in your browser.</p>

    <hr>

    <h2>Your Progress</h2>
    <p id="progressText"></p>
    <div style="background:#ddd; width:100%; height:20px; border-radius:5px; margin-bottom:20px;">
        <div id="progressBar" style="background:#4CAF50; height:100%; width:0%; border-radius:5px;"></div>
    </div>

    <h2>Submit Flags</h2>

    <div id="challenges"></div>
</div>

<script>
// All flags
const FLAGS = {
    "Challenge 1 — HTML Inspection": "flag{simple_ctf_html}",
    "Challenge 2 — JavaScript Password": "flag{simple_ctf_js}",
    "Challenge 3 — URL Manipulation": "flag{simple_ctf_param}",
    "Challenge 4 — Encoding": "flag{simple_ctf_encoding}",
    "Challenge 5 — robots.txt": "flag{simple_ctf_robots}",
    "Challenge 6 — Cookie Challenge": "flag{simple_ctf_cookie}",
    "Bonus — Reflected Input (XSS Awareness)": "flag{simple_ctf_bonus_xss}",
    "Bonus — Crypto Puzzle (ROT13)": "flag{simple_ctf_crypto}",
    "Bonus — SQL Injection Simulation": "flag{simple_ctf_sql}",
    "Bonus — Image Metadata": "flag{simple_ctf_stego}",
    "Bonus — Log Analysis": "flag{simple_ctf_logs}"
};

// Hints for each challenge
const HINTS = {
    "Challenge 1 — HTML Inspection": "Hint: Right-click the page and select 'View Page Source' or 'Inspect'.",
    "Challenge 2 — JavaScript Password": "Hint: Check the JavaScript console. Functions need () to run.",
    "Challenge 3 — URL Manipulation": "Hint: Try changing URL parameters like role=user → role=admin.",
    "Challenge 4 — Encoding": "Hint: The flag is Base64-encoded.",
    "Challenge 5 — robots.txt": "Hint: Check /robots.txt for hidden files (remember: flag.html).",
    "Challenge 6 — Cookie Challenge": "Hint: Modify the 'role' cookie in DevTools → Application → Cookies.",
    "Bonus — Reflected Input (XSS Awareness)": "Hint: Try entering <script> to see how the page reacts.",
    "Bonus — Crypto Puzzle (ROT13)": "Hint: ROT13 shifts letters by 13. Use an online decoder.",
    "Bonus — SQL Injection Simulation": "Hint: Try entering: ' OR 1=1",
    "Bonus — Image Metadata": "Hint: Images can contain hidden metadata beyond just pixels.",
    "Bonus — Log Analysis": "Hint: Find the repeated suspicious IP in the logs."
};

// Explanations shown after solving
const EXPLANATIONS = {
    "Challenge 1 — HTML Inspection":
        "This challenge teaches you to inspect HTML source code. Secrets should never be stored in front-end code, since users can always view it.",

    "Challenge 2 — JavaScript Password":
        "This teaches you that client-side password checks are insecure. Attackers can read or bypass JavaScript easily.",

    "Challenge 3 — URL Manipulation":
        "This demonstrates insecure access control via URL parameters. Never rely on client-controlled parameters to set permissions.",

    "Challenge 4 — Encoding":
        "This teaches that encoding (like Base64) is NOT encryption. Encoded data is easily reversible and should not be used for security.",

    "Challenge 5 — robots.txt":
        "robots.txt is public and only tells respectful bots where not to go. Never hide sensitive files there.",

    "Challenge 6 — Cookie Challenge":
        "Cookies can be edited by the user. Sensitive data should be validated server-side and stored securely (e.g., signed tokens).",

    "Bonus — Reflected Input (XSS Awareness)":
        "This demonstrates reflected XSS. Always sanitize user input before displaying it back to the page.",

    "Bonus — Crypto Puzzle (ROT13)":
        "ROT13 is not real cryptography. This teaches the difference between simple encoding and proper encryption.",

    "Bonus — SQL Injection Simulation":
        "This shows why user input must be properly sanitized or parameterized to prevent SQL injection attacks.",

    "Bonus — Image Metadata":
        "This teaches that files often contain hidden metadata such as EXIF data or embedded comments. Never store secrets in metadata.",

    "Bonus — Log Analysis":
        "This challenge teaches log forensics: patterns, repeated attempts, and suspicious IP addresses help detect attacks."
};

// Load saved progress from browser
let progress = JSON.parse(localStorage.getItem("ctf_progress")) || {};

function saveProgress() {
    localStorage.setItem("ctf_progress", JSON.stringify(progress));
    updateProgressDisplay();
}

function updateProgressDisplay() {
    let completed = Object.values(progress).filter(v => v === true).length;
    let total = Object.keys(FLAGS).length;

    document.getElementById("progressText").innerText =
        `Completed: ${completed} / ${total} challenges`;

    let percent = (completed / total) * 100;
    document.getElementById("progressBar").style.width = percent + "%";
}

// Build UI
const container = document.getElementById("challenges");

Object.keys(FLAGS).forEach(title => {
    const div = document.createElement("div");
    div.style.marginBottom = "25px";

    div.innerHTML = `
        <strong>${title}</strong><br>
        <input id="input-${title}" placeholder="Enter flag" style="width:300px;">
        <button onclick="checkFlag('${title}')">Submit</button>
        <span id="result-${title}" style="margin-left:10px;"></span><br>
        <button onclick="showHint('${title}')" style="margin-top:5px;">Show Hint</button>
        <div id="hint-${title}" style="margin-top:5px; color:blue;"></div>
        <div id="explain-${title}" style="margin-top:10px; color:green; font-style:italic;"></div>
    `;

    container.appendChild(div);
});

function checkFlag(title) {
    const inputField = document.getElementById(`input-${title}`);
    const resultField = document.getElementById(`result-${title}`);
    const explainField = document.getElementById(`explain-${title}`);

    if (inputField.value.trim() === FLAGS[title]) {
        resultField.innerHTML = "<span style='color:green;'>✔ Correct!</span>";
        explainField.innerText = EXPLANATIONS[title] || "";
        progress[title] = true;
        saveProgress();
    } else {
        resultField.innerHTML = "<span style='color:red;'>✖ Incorrect</span>";
        explainField.innerText = "";
    }
}

function showHint(title) {
    const hintField = document.getElementById(`hint-${title}`);
    hintField.innerText = HINTS[title];
}

updateProgressDisplay();
</script>
</body>
</html>
